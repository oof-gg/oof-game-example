const connections=[];self.addEventListener("connect",(e=>{console.log("[SharedWorker] Connected to SharedWorker:",e);const o=e.ports[0];connections.push(o),console.log("[SharedWorker] New client connected. Total clients:",connections.length),o.onmessage=function(e){if(console.log("[SharedWorker] Worker received message:",e.data),connections.forEach((n=>{n!==o&&(console.log("[SharedWorker] Worker sending message:",e.data),n.postMessage(e.data))})),"local"===e.data.namespace&&"CLOSE"===e.data.eventType){console.log("[SharedWorker] Closing port:",o);const e=connections.indexOf(o);connections.splice(e,1),o.close(),self.close()}}}));